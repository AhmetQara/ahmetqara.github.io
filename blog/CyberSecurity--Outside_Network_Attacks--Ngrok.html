<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Ngrok</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Ngrok</h1><br/><br /><strong><span style="color:#e01b24;">Ngrok Kullanımı</span></strong><br /><br />Ngrok sitesinden kayıt olup giriş yaptıktan sonra kullandığımız işletim sistemine göre olan versiyonu indirip cihaza kuruyoruz.   <br />Linux için kurulum örneğini göstererek devam edelim;<br /><br /><img src="images/55-1.png" alt="images/55-1.png" />Kurulum için indirdiğimiz ngrok.zip dosyasını “unzip” komutu ile çıkartıyoruz.<br /><br /><img src="images/55-2.png" alt="images/55-2.png" /><br /><br /> çıkarttığımız klasörde bulunan “ngrok” dosyasını terminal üzerinden hesabımızı bağlamak için resimde görüldüğü şekilde “./ngrok authoken 1Tt....” komutu yazıp bize verilen tokeni yapıştırıp çalıştırmamız gerekiyor<br /> <br /><br /><img src="images/55-3.png" alt="images/55-3.png" /> <br />  <br />  ardından böyle bir yazı görmemiz lazım ve “ngrok.yml” adında bir dosya oluşturup içine gerekli bilgilerimizi kaydetmesi lazım. Bu kayıt işlemini bir kerelik yapıyoruz.<br /><br /> Ardından istersek “./ngrok help” komutunu yazarak help dokümanını görüntüleyebiliriz;<br /> <br /><br /><img src="images/55-4.png" alt="images/55-4.png" /><br /><br />Şimdi ngrok ile bir port üzerinden dinlemeyi başlatalım;<br /><br /><img src="images/55-5.png" alt="images/55-5.png" />4242 gibi çok kullanılmayan bir port ile dinlemeyi(listening) başlatıyoruz. Bunu başlatmamız şu demek; Bu porta (4242) gelecek olan bağlantıları dinlemeye başladığımızı belirtiyoruz.<br /><br /> Bu komutu yazıp çalıştırdıktan sonra şöyle bir pencereye geçiş yapıyoruz;<br /> <br /> <img src="images/55-6.png" alt="images/55-6.png" /> <br />  <br />  burada Forwarding kısmında kırmızı ile çizili &quot;tcp://5.tcp.eu....&quot; kısmı bize ngrok tunneling servisinin dinlememiz için verdiği sunucu IP adresidir. İşte bu adres üzerinden gelen bağlantıları localhost kısmında açtığımız 4242 portu üzerinden dinleyeceğiz, servis bize bu açtığımız port(4242) üzerinden gelen verileri iletecek. Bu sayede kendi IP adresimizi açık etmeden bu şekilde local port açarak bu servis üzerinden dinleme yapabileceğiz. Bu noktada önemli bir hatırlatma yapmak gerek; biz bir backdoor, trojan vs oluştururken artık LHOST, LPORT kısımlarına ngrok servisinin bize verdiği (bu örnekte “LHOST: tcp://5.tcp.eu.ngrok.io ve LPORT: 10405”) bilgileri gireceğiz. Bunun sebebi sanki biz ngrok servisinde local olarak bu backdoor&#39;u oluşturup dinlemeye başlıyormuşuz gibi yapıyoruz. Bunun nasıl yapılacağını göstererek devam edelim.<br /> <br />  Ngrok çalıştırdığımız terminal penceresini kapatmadan başka bir terminal penceresi açıyoruz. Çünkü ngrok çalışmaya devam  etmeli.<br /> <br />  Şimdi msfvenom ile ngrok bilgilerimize uygun bir backdoor oluşturalım;<br /> <br /> <img src="images/55-7.png" alt="images/55-7.png" /><br /> <br />  Bu şekilde windows üzerinde çalışacak .exe uzantılı bir backdoor oluşturduk. Burada altı kırmızı ile çizilerek belirtilen “lhost” ve “lport” kısımlarına dikkat et, kendi bilgilerimizi değil ngrok çalıştırdığımızda bize verilen lhost,lport değerlerini girdik. Şimdi dinlemeyi başlattıktan sonra bu oluşturduğumuz backdoor&#39;u karşı cihazda yani windows cihazda çalıştıracağız. <br /> <br /> Dinlemeyi başlatmak için msfconsole kullanabiliriz;<br /> <br /> <img src="images/55-8.png" alt="images/55-8.png" /><br /> <br /> reverse_tcp ile dinleyeceğiz o yüzden payload&#39;ı ona göre ayarladık. Ardından;<br /> <br /> <img src="images/55-9.png" alt="images/55-9.png" /><br /> <br />  bilgilerimizi bu şekilde ayarlıyoruz. İşte burada LHOST için 0.0.0.0 vermemizin sebebi; Biz zaten ngrok servisinde açtığımız sunucu üzerinden gelen verileri dinliyoruz o yüzden sanki ngrok da açılan sunucudaymış gibi localhost default değeri olarak 0.0.0.0 şeklinde veriyoruz. <br /> <br /> Gerekli ayarlamaları yaptık;<br /> <br /> <img src="images/55-10.png" alt="images/55-10.png" /><br /> <br /> artık “exploit” komutu ile dinlemeye başlayabiliriz hatta arka planda çalışması için “exploit -j -z” komutunu verelim;<br /> <br /> <img src="images/55-11.png" alt="images/55-11.png" />dinleme başladı....<br /> <br /> Windows cihazda bizim oluşturduğumuz backdoor çalıştığı anda;<br /> <br /> <img src="images/55-12.png" alt="images/55-12.png" /><br /> <br /> bize bu şekilde bağlantı geliyor ve artık cihaza sızmış bulunuyoruz.<br /> <br /> </div>
</body>
</html>
